\chapter{Feature extraction}
\label{apdx:sec:feature_extraction}

This chapter presents the collection of graphs illustrating the performance of the \gls{ids} over all the datasets.

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/DoS/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_carhacking_dos_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/DoS/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_carhacking_dos_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/DoS/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_carhacking_dos_hammingdist}
    \end{subfigure}
    \caption{Car Hacking - \gls{dos}}
    \label{fig:extract_carhacking_dos}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/fuzzy/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_carhacking_fuzzy_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/fuzzy/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_carhacking_fuzzy_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/fuzzy/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_carhacking_fuzzy_hammingdist}
    \end{subfigure}
    \caption{Car Hacking - Fuzzing}
    \label{fig:extract_carhacking_fuzzy}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/gear/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_carhacking_gear_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/gear/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_carhacking_gear_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/gear/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_carhacking_gear_hammingdist}
    \end{subfigure}
    \caption{Car Hacking - Gear spoofing}
    \label{fig:extract_carhacking_gear}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/rpm/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_carhacking_rpm_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/rpm/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_carhacking_rpm_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/car_hacking/rpm/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_carhacking_rpm_hammingdist}
    \end{subfigure}
    \caption{Car Hacking - RPM spoofing}
    \label{fig:extract_carhacking_rpm}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/ieee/driving/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_ieee_d_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/ieee/driving/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_ieee_d_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/ieee/driving/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_ieee_d_hammingdist}
    \end{subfigure}
    \caption{IEEE Car Hacking: Attack \& Defense Challenge 2020 - Driving Submission}
    \label{fig:extract_ieee_d}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/ieee/stationary_submission/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_ieee_s_s_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/ieee/stationary_submission/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_ieee_s_s_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/ieee/stationary_submission/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_ieee_s_s_hammingdist}
    \end{subfigure}
    \caption{IEEE Car Hacking: Attack \& Defense Challenge 2020 - Stationary Submission}
    \label{fig:extract_ieee_s_s}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/ieee/stationary_final/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_ieee_s_f_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/ieee/stationary_final/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_ieee_s_f_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/ieee/stationary_final/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_ieee_s_f_hammingdist}
    \end{subfigure}
    \caption{IEEE Car Hacking: Attack \& Defense Challenge 2020 - Stationary Final}
    \label{fig:extract_ieee_s_f}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/OpelAstra/fuzzing/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_tue_opelastra_fuzzing_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/OpelAstra/fuzzing/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_tue_opelastra_fuzzing_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/OpelAstra/fuzzing/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_tue_opelastra_fuzzing_hammingdist}
    \end{subfigure}
    \caption{Automotive Controller Area Network (CAN) Bus Intrusion Dataset v2 - Opel Astra - Fuzzing attack}
    \label{fig:extract_tue_opelastra_fuzzing}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/OpelAstra/deletion/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_tue_opelastra_deletion_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/OpelAstra/deletion/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_tue_opelastra_deletion_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/OpelAstra/deletion/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_tue_opelastra_deletion_hammingdist}
    \end{subfigure}
    \caption{Automotive Controller Area Network (CAN) Bus Intrusion Dataset v2 - Opel Astra - Message deletion attack}
    \label{fig:extract_tue_opelastra_deletion}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/OpelAstra/replay/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_tue_opelastra_replay_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/OpelAstra/replay/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_tue_opelastra_replay_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/OpelAstra/replay/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_tue_opelastra_replay_hammingdist}
    \end{subfigure}
    \caption{Automotive Controller Area Network (CAN) Bus Intrusion Dataset v2 - Opel Astra - Replay attack}
    \label{fig:extract_tue_opelastra_replay}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/RenaultClio/fuzzing/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_tue_renaultclio_fuzzing_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/RenaultClio/fuzzing/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_tue_renaultclio_fuzzing_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/RenaultClio/fuzzing/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_tue_renaultclio_fuzzing_hammingdist}
    \end{subfigure}
    \caption{Automotive Controller Area Network (CAN) Bus Intrusion Dataset v2 - Renault Clio - Fuzzing attack}
    \label{fig:extract_tue_renaultclio_fuzzing}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/RenaultClio/deletion/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_tue_renaultclio_deletion_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/RenaultClio/deletion/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_tue_renaultclio_deletion_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/RenaultClio/deletion/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_tue_renaultclio_deletion_hammingdist}
    \end{subfigure}
    \caption{Automotive Controller Area Network (CAN) Bus Intrusion Dataset v2 - Renault Clio - Message deletion attack}
    \label{fig:extract_tue_renaultclio_deletion}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/RenaultClio/replay/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_tue_renaultclio_replay_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/RenaultClio/replay/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_tue_renaultclio_replay_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/tue/RenaultClio/replay/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_tue_renaultclio_replay_hammingdist}
    \end{subfigure}
    \caption{Automotive Controller Area Network (CAN) Bus Intrusion Dataset v2 - Renault Clio - Replay attack}
    \label{fig:extract_tue_renaultclio_replay}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/add_incr/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_crysys_addincr_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/add_incr/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_crysys_addincr_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/add_incr/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_crysys_addincr_hammingdist}
    \end{subfigure}
    \caption{Modified CrySyS Lab - Adding an increasing value}
    \label{fig:extract_crysys_addincr}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/const/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_crysys_const_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/const/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_crysys_const_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/const/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_crysys_const_hammingdist}
    \end{subfigure}
    \caption{Modified CrySyS Lab - Constant value}
    \label{fig:extract_crysys_const}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/decr/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_crysys_decr_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/decr/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_crysys_decr_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/decr/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_crysys_decr_hammingdist}
    \end{subfigure}
    \caption{Modified CrySyS Lab - Decreasing value}
    \label{fig:extract_crysys_decr}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/delta/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_crysys_delta_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/delta/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_crysys_delta_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/delta/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_crysys_delta_hammingdist}
    \end{subfigure}
    \caption{Modified CrySyS Lab - Delta of 1000}
    \label{fig:extract_crysys_delta}
\end{figure}

\begin{figure}
    \centering
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/rand/AvgTime.png}
        \caption{Average time between packets}
        \label{subfig:extract_crysys_rand_avgtime}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/rand/Entropy.png}
        \caption{Average entropy}
        \label{subfig:extract_crysys_rand_entropy}
    \end{subfigure}
    \begin{subfigure}[b]{\linewidth}
        \includegraphics[width = \linewidth]{img/parts/app/tests/crysys/rand/HammingDist.png}
        \caption{Average Hamming distance}
        \label{subfig:extract_crysys_rand_hammingdist}
    \end{subfigure}
    \caption{Modified CrySyS Lab - Random value}
    \label{fig:extract_crysys_rand}
\end{figure}